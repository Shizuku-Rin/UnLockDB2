name: C++ Build and Package for Windows

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:

    runs-on: windows-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2  # 检出代码

    - name: Set up MSYS2
      run: |
        choco install msys2
        refreshenv
        pacman -Syu --noconfirm
        pacman -S --noconfirm base-devel mingw-w64-x86_64-gcc

    - name: Build with g++
      run: |
        # 使用 g++ 编译 C++ 代码
        g++ -o my_program.exe src/main.cpp  # 假设你的 C++ 源文件位于 src 目录
        ls -al  # 列出文件查看输出

    - name: Upload .exe as artifact
      uses: actions/upload-artifact@v2
      with:
        name: my_program
        path: my_program.exe  # 上传生成的 .exe 文件
